<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 중요: 모든 HTTP 요청을 HTTPS로 자동 업그레이드 -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> 
    <title>시크릿클래스 - 대한민국 1호 아파트 큐레이터</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        .hidden{display:none !important;}

        /* 폰트 설정 */
        @font-face {
            font-family: 'Jalnan';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonnu-fonts_two@1.0/Jalnan.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap');

        /* 기본 스타일 */
        :root { --primary: #4f46e5; --primary-dark: #4338ca; }
        * { font-family: 'Jalnan', sans-serif; }
        body { font-family: 'Pretendard', sans-serif; letter-spacing: -0.02em; overflow-x: hidden; }
        
        /* 유틸리티 */
        .font-jalnan { font-family: 'Jalnan', sans-serif !important; }
        .font-body { font-family: 'Pretendard', sans-serif !important; }
        .break-keep { word-break: keep-all; word-wrap: break-word; }
        
        /* 스크롤바 */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* 애니메이션 */
        @keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fade-in 0.5s ease-out forwards; }
        
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .animate-float { animation: float 6s ease-in-out infinite; }

        .hidden-section { display: none !important; }
        
        /* 후기 카드: 카드에서는 디자인 통일성을 위해 줄임 처리, 모달에서 전체 노출 */
        .line-clamp-custom {
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
            overflow: hidden;
            height: 6rem; 
        }

        /* 모달 내용: 원본 텍스트 보존 */
        .raw-content {
            line-height: 1.7;
            white-space: pre-wrap; /* 줄바꿈, 띄어쓰기 원본 그대로 표시 */
            color: #374151;
            font-size: 1rem;
        }
    </style>
</head>
<body class="bg-white text-gray-900 font-body flex flex-col min-h-screen">

    <!-- 1. 최상단 배너 -->
    <div class="bg-red-600 text-white text-center py-3 text-sm md:text-base shadow-md z-50 relative break-keep px-4">
        <div class="animate-pulse flex justify-center items-center gap-2">
            <span class="font-bold bg-white text-red-600 px-2 py-0.5 rounded text-xs">마감임박</span>
            <span>이번 달 큐레이팅 마감까지 <span id="countdown-number" class="text-yellow-300 font-extrabold text-lg">2</span>자리 남았습니다.</span>
        </div>
    </div>

    <!-- 2. 헤더 -->
    <header class="sticky top-0 z-40 bg-white/95 backdrop-blur-md border-b border-gray-100 transition-all duration-300">
        <!-- 로그인 상태 바 -->
        <div class="bg-gray-50 border-b border-gray-100">
            <div class="max-w-7xl mx-auto px-4 py-2 flex justify-end items-center gap-4 text-xs text-gray-500">
                <div id="auth-guest" class="flex items-center gap-3">
                    <button onclick="window.App.openModal('loginModal', 'login')" class="hover:text-indigo-600 transition-colors">로그인</button>
                    <span class="w-px h-3 bg-gray-300"></span>
                    <button onclick="window.App.openModal('loginModal', 'signup')" class="hover:text-indigo-600 transition-colors">회원가입</button>
                </div>
                <div id="auth-user" class="hidden-section flex items-center gap-3">
                    <!-- 관리자 버튼 -->
                    <button id="btn-admin-open" onclick="window.App.openAdminModal()" class="hidden bg-gray-800 text-white px-2 py-1 rounded hover:bg-gray-700 transition-colors mr-2">
                        <i data-lucide="settings" class="w-3 h-3 inline"></i> 관리자
                    </button>
                    <span class="font-bold text-gray-700"><span id="user-name-display" class="text-indigo-600"></span>님</span>
                    <span class="w-px h-3 bg-gray-300"></span>
                    <button onclick="window.App.logout()" class="hover:text-red-500 transition-colors">로그아웃</button>
                </div>
                <span class="w-px h-3 bg-gray-300"></span>
                <button onclick="window.App.openMypage()" class="font-bold text-indigo-600 hover:text-indigo-800 transition-colors flex items-center gap-1">
                    <i data-lucide="user" class="w-3 h-3"></i> 나의강의실
                </button>
            </div>
        </div>

        <!-- 네비게이션 -->
        <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex justify-between items-center w-full md:w-auto">
                <a href="javascript:void(0)" onclick="window.App.navigate('home')" class="text-left group cursor-pointer">
                    <div class="text-2xl font-jalnan font-bold text-indigo-900 tracking-tighter group-hover:text-indigo-700 transition-colors">시크릿클래스</div>
                    <div class="text-[10px] text-indigo-400 tracking-[0.3em] font-light">SECRETCLASS</div>
                </a>
                <button class="md:hidden p-2" onclick="window.App.toggleMobileMenu()">
                    <i data-lucide="menu" class="h-6 w-6 text-gray-800"></i>
                </button>
            </div>
            
            <nav class="hidden md:flex gap-8 font-medium text-gray-600">
                <button onclick="window.App.scrollToSection('about')" class="hover:text-indigo-600 transition-colors py-2">소개</button>
                <button onclick="window.App.scrollToSection('curriculum')" class="hover:text-indigo-600 transition-colors py-2">진행과정</button>
                <button onclick="window.App.scrollToSection('pricing')" class="hover:text-indigo-600 transition-colors py-2">수강신청</button>
                <button onclick="window.App.scrollToSection('reviews')" class="hover:text-indigo-600 transition-colors py-2">강의후기</button>
                <button onclick="window.App.scrollToSection('faq')" class="hover:text-indigo-600 transition-colors py-2">고객센터</button>
            </nav>
        </div>

        <!-- 모바일 메뉴 -->
        <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-gray-100 absolute w-full left-0 shadow-lg animate-fade-in z-50">
            <div class="flex flex-col text-gray-700">
                <button onclick="window.App.scrollToSection('about'); window.App.toggleMobileMenu()" class="text-left py-4 px-6 border-b border-gray-50 hover:bg-gray-50">소개</button>
                <button onclick="window.App.scrollToSection('curriculum'); window.App.toggleMobileMenu()" class="text-left py-4 px-6 border-b border-gray-50 hover:bg-gray-50">진행과정</button>
                <button onclick="window.App.scrollToSection('pricing'); window.App.toggleMobileMenu()" class="text-left py-4 px-6 border-b border-gray-50 hover:bg-gray-50">수강신청</button>
                <button onclick="window.App.scrollToSection('reviews'); window.App.toggleMobileMenu()" class="text-left py-4 px-6 border-b border-gray-50 hover:bg-gray-50">강의후기</button>
                <button onclick="window.App.scrollToSection('faq'); window.App.toggleMobileMenu()" class="text-left py-4 px-6 border-b border-gray-50 hover:bg-gray-50">고객센터</button>
            </div>
        </div>
    </header>

    <!-- 메인 컨텐츠 영역 (SPA) -->
    <main id="main-container" class="flex-grow">
        
        <!-- [VIEW 1] 홈 화면 -->
        <div id="view-home" class="view-section">
            <!-- Hero -->
            <section class="relative overflow-hidden bg-gray-900 min-h-[600px] flex items-center">
                <div class="absolute inset-0 bg-gradient-to-br from-gray-900 via-[#1e293b] to-indigo-950 z-0"></div>
                <div class="absolute inset-0 opacity-10" style="background-image: url('https://www.transparenttextures.com/patterns/cubes.png');"></div>
                
                <div class="max-w-7xl mx-auto px-4 w-full flex flex-col md:flex-row items-center justify-between gap-10 relative z-10 py-16">
                    <div class="text-center md:text-left text-white w-full md:w-[60%]">
                        <div class="inline-block px-4 py-1.5 bg-indigo-500/20 backdrop-blur-md rounded-full text-sm font-bold border border-indigo-400/30 text-indigo-300 mb-6">
                            🏆 대한민국 1호 아파트 큐레이터
                        </div>
                        <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-[4.5rem] font-jalnan leading-tight mb-6">
                            부동산 유목민의<br>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-yellow-500">마지막 종착지!</span>
                        </h1>
                        <p class="text-gray-300 text-lg md:text-xl mb-10 font-light leading-relaxed">
                            김작가TV, 신사임당, 월부 등 압도적 초청!<br>
                            <strong class="text-white font-bold border-b-2 border-indigo-500">내 집 마련과 투자의 완결</strong>을 설계합니다.
                        </p>
                        <button onclick="window.App.scrollToSection('pricing')" class="px-8 py-4 rounded-full font-bold text-lg bg-indigo-600 text-white hover:bg-indigo-500 transition-all shadow-[0_0_30px_rgba(79,70,229,0.4)] flex items-center justify-center gap-2 mx-auto md:mx-0">
                            지금 바로 시작하기 <i data-lucide="arrow-right" class="w-5 h-5"></i>
                        </button>
                    </div>
                    
                    <div class="w-full md:w-[40%] relative h-[300px] md:h-[400px] flex items-center justify-center animate-float">
                        <div class="absolute w-72 h-72 bg-indigo-600/30 rounded-full blur-[80px] animate-pulse"></div>
                        <a href="https://www.yes24.com/product/goods/104491194" target="_blank" class="absolute transform -rotate-12 -translate-x-8 hover:z-20 hover:scale-110 hover:rotate-0 transition-all duration-500 cursor-pointer z-10">
                            <img src="https://image.yes24.com/goods/104491194/XL" alt="책1" class="w-40 md:w-52 rounded-r-lg shadow-2xl border-l-2 border-gray-700">
                        </a>
                        <a href="https://www.yes24.com/product/goods/122689813" target="_blank" class="absolute transform rotate-6 translate-x-8 z-10 hover:z-20 hover:scale-110 hover:rotate-0 transition-all duration-500 cursor-pointer">
                            <img src="https://image.yes24.com/goods/122689813/XL" alt="책2" class="w-40 md:w-52 rounded-r-lg shadow-2xl border-l-2 border-gray-700">
                        </a>
                    </div>
                </div>
            </section>

            <!-- About Section -->
            <section id="about" class="py-24 bg-white">
                <div class="max-w-6xl mx-auto px-4">
                    <div class="flex flex-col lg:flex-row items-center gap-16">
                        <div class="w-full lg:w-1/2 relative">
                            <div class="bg-gray-100 rounded-[2.5rem] p-6 relative z-10 border border-gray-200 shadow-xl">
                                <div class="aspect-[4/5] bg-gray-200 rounded-[2rem] overflow-hidden relative border-2 border-gray-300">
                                    <img src="./3.jpg" onerror="this.src='https://images.unsplash.com/photo-1560250097-0b93528c311a?q=80&w=1000&auto=format&fit=crop'" alt="시크릿브라더" class="w-full h-full object-cover">
                                </div>
                            </div>
                        </div>

                        <div class="w-full lg:w-1/2">
                            <span class="text-indigo-600 font-bold tracking-widest text-sm mb-2 block">WHO AM I</span>
                            <h2 class="text-3xl md:text-4xl font-jalnan mb-6 leading-tight">
                                '아파트 큐레이터'<br>
                                <span class="text-indigo-600 relative inline-block">시크릿브라더</span>입니다.
                            </h2>
                            <div class="text-gray-600 text-lg leading-relaxed mb-8 space-y-4 break-keep border-l-4 border-gray-200 pl-6">
                                <p class="font-bold text-gray-900">"아직도 살지 말지 고민하시나요?"</p>
                                <p>저는 대한민국 1호 ‘초이스헬퍼’로서 여러분의 후회 없는 선택을 설계해드리고 있습니다. 실제 투자와 상담으로 검증된 인사이트로, 당신에게 맞는 한 채를 함께 고르겠습니다.</p>
                            </div>
                            
                            <div class="space-y-3 mb-8">
                                <a href="https://youtu.be/Xg5GV-b-7rU?si=UtnPM4Z31Hnn-VxB" target="_blank" class="flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-100 hover:bg-white hover:border-red-200 hover:shadow-lg transition-all group">
                                    <span class="w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-xs font-bold text-indigo-700 flex-shrink-0">1</span>
                                    <div class="flex-1 font-bold text-gray-800 group-hover:text-red-600">김작가TV & 신사임당 & 월부 출연 영상</div>
                                    <i data-lucide="youtube" class="text-gray-400 group-hover:text-red-600"></i>
                                </a>
                                <a href="https://blog.naver.com/secret-brother" target="_blank" class="flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-100 hover:bg-white hover:border-green-200 hover:shadow-lg transition-all group">
                                    <span class="w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-xs font-bold text-indigo-700 flex-shrink-0">2</span>
                                    <div class="flex-1 font-bold text-gray-800 group-hover:text-green-600">누적 방문자 200만 블로거</div>
                                    <i data-lucide="external-link" class="text-gray-400 group-hover:text-green-600"></i>
                                </a>
                            </div>
                            
                            <a href="https://youtu.be/j0hFCMX5Qlc?si=U3O5iBJjyOPEQl1g" target="_blank" class="w-full md:w-auto px-8 py-4 bg-gray-900 text-white rounded-xl font-bold flex items-center justify-center gap-3 hover:bg-gray-800 transition-all shadow-lg">
                                <i data-lucide="play-circle" class="w-5 h-5"></i> 시크릿브라더 대표 영상 보기
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Curriculum Section -->
            <section id="curriculum" class="py-24 bg-gray-900 text-white relative overflow-hidden">
                <div class="absolute inset-0 bg-gray-900 opacity-20" style="background-image: url('https://www.transparenttextures.com/patterns/stardust.png');"></div>
                <div class="max-w-6xl mx-auto px-4 relative z-10">
                    <div class="text-center mb-16">
                        <span class="text-indigo-400 font-bold tracking-widest text-sm mb-2 block">SYSTEM</span>
                        <h2 class="text-3xl md:text-4xl font-jalnan mb-4">1:1 큐레이팅 프로세스</h2>
                        <p class="text-gray-400">체계적인 4단계 시스템으로 당신의 내 집 마련을 완성합니다.</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 relative">
                        <div class="hidden md:block absolute top-12 left-0 w-full h-0.5 bg-gradient-to-r from-gray-800 via-indigo-600 to-gray-800"></div>
                        <div class="bg-gray-800/50 backdrop-blur border border-gray-700 p-8 rounded-2xl relative group hover:-translate-y-2 transition-transform duration-300">
                            <div class="w-16 h-16 rounded-full bg-indigo-600 flex items-center justify-center font-bold text-2xl mb-6 mx-auto shadow-[0_0_20px_rgba(79,70,229,0.5)] z-10 relative">1</div>
                            <h3 class="text-xl font-bold mb-2 text-center">사전 설문</h3>
                            <p class="text-sm text-gray-400 text-center break-keep">투자 성향 및 자산 현황을 정밀하게 진단합니다.</p>
                        </div>
                        <div class="bg-gray-800/50 backdrop-blur border border-gray-700 p-8 rounded-2xl relative group hover:-translate-y-2 transition-transform duration-300">
                            <div class="w-16 h-16 rounded-full bg-indigo-700 flex items-center justify-center font-bold text-2xl mb-6 mx-auto shadow-[0_0_20px_rgba(67,56,202,0.5)] z-10 relative">2</div>
                            <h3 class="text-xl font-bold mb-2 text-center">맞춤 분석</h3>
                            <p class="text-sm text-gray-400 text-center break-keep">최적의 지역과 단지를 선정하고 포트폴리오를 설계합니다.</p>
                        </div>
                        <div class="bg-gray-800/50 backdrop-blur border border-gray-700 p-8 rounded-2xl relative group hover:-translate-y-2 transition-transform duration-300">
                            <div class="w-16 h-16 rounded-full bg-indigo-800 flex items-center justify-center font-bold text-2xl mb-6 mx-auto shadow-[0_0_20px_rgba(55,48,163,0.5)] z-10 relative">3</div>
                            <h3 class="text-xl font-bold mb-2 text-center">1:1 밀착 상담</h3>
                            <p class="text-sm text-gray-400 text-center break-keep">7일간 카카오톡을 통해 실시간 솔루션을 제공합니다.</p>
                        </div>
                        <div class="bg-gray-800/50 backdrop-blur border border-yellow-500/30 p-8 rounded-2xl relative group hover:-translate-y-2 transition-transform duration-300">
                            <div class="w-16 h-16 rounded-full bg-yellow-500 text-indigo-900 flex items-center justify-center font-bold text-2xl mb-6 mx-auto shadow-[0_0_20px_rgba(234,179,8,0.5)] z-10 relative">4</div>
                            <h3 class="text-xl font-bold mb-2 text-center text-yellow-400">실행 및 관리</h3>
                            <p class="text-sm text-gray-400 text-center break-keep">매수 타이밍 설정 및 향후 방향성까지 제시합니다.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Pricing Section -->
            <section id="pricing" class="py-24 bg-indigo-50/50">
                <div class="max-w-4xl mx-auto px-4">
                    <div class="bg-white rounded-[2rem] shadow-2xl overflow-hidden border border-indigo-100 relative">
                        <div class="absolute top-0 w-full h-2 bg-gradient-to-r from-indigo-500 to-purple-600"></div>
                        <div class="p-10 md:p-14 text-center">
                            <span class="inline-block py-1 px-3 rounded-full text-xs font-bold mb-6 bg-indigo-100 text-indigo-700 tracking-wide">PREMIUM SERVICE</span>
                            <h2 class="text-3xl md:text-4xl font-jalnan text-gray-900 mb-4">1:1 맞춤형 투자 큐레이팅</h2>
                            <p class="text-gray-500 mb-10 max-w-lg mx-auto break-keep">당신의 자산 상황과 목표에 맞춘 100% 개인화 포트폴리오 제안 및 심층 상담 서비스입니다.</p>
                            
                            <div class="flex flex-col items-center justify-center mb-10">
                                <span class="text-gray-400 text-xl line-through decoration-red-400 decoration-2 mb-1">699,000원</span>
                                <div class="flex items-center gap-3">
                                    <div class="flex items-baseline gap-1">
                                        <span class="text-6xl font-extrabold text-indigo-600 font-jalnan">349,000</span>
                                        <span class="text-2xl text-gray-600 font-bold">원</span>
                                    </div>
                                    <span class="bg-red-500 text-white text-base font-bold px-3 py-1 rounded-full shadow-lg animate-bounce transform -rotate-2">
                                        50% OFF
                                    </span>
                                </div>
                            </div>

                            <div class="grid gap-4 max-w-sm mx-auto">
                                <a href="https://portone.io/korea/ko" target="_blank" onclick="window.App.checkPayment(event, this.href)" class="w-full py-4 bg-gray-900 hover:bg-gray-800 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2">
                                    <i data-lucide="credit-card" class="w-5 h-5"></i> 카드 / 간편결제 신청
                                </a>
                                <button onclick="window.App.openModal('depositModal')" class="w-full py-4 bg-white border-2 border-gray-200 text-gray-700 hover:border-indigo-500 hover:text-indigo-600 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-2">
                                    <i data-lucide="wallet" class="w-5 h-5"></i> 무통장 입금 신청
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reviews Section -->
            <section id="reviews" class="py-24 bg-white">
                <div class="max-w-7xl mx-auto px-4">
                    <div class="text-center mb-16">
                        <span class="text-indigo-600 font-bold tracking-widest text-sm mb-2 block">REVIEWS</span>
                        <h2 class="text-3xl md:text-4xl font-jalnan mb-4">수강생 리얼 후기</h2>
                        <p class="text-gray-600">조작 없는 100% 실제 수강생들의 이야기입니다.</p>
                    </div>
                    
                    <div class="mb-12">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                            <i data-lucide="trophy" class="text-yellow-500 fill-current w-6 h-6"></i> 명예의 전당 (BEST)
                        </h3>
                        <div id="best-reviews-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 min-h-[200px]"></div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="window.App.navigate('reviews')" class="inline-flex items-center gap-2 bg-white border-2 border-indigo-600 text-indigo-600 hover:bg-indigo-600 hover:text-white px-10 py-4 rounded-full font-bold text-lg transition-all shadow-md hover:shadow-lg group">
                            실시간 전체 후기 보러가기 <i data-lucide="arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- FAQ Section -->
            <section id="faq" class="py-24 bg-gray-50">
                <div class="max-w-3xl mx-auto px-4">
                    <h2 class="text-3xl font-jalnan text-center mb-12">자주 묻는 질문</h2>
                    <div class="space-y-4">
                        <div class="bg-white rounded-2xl border border-gray-200 overflow-hidden">
                            <button onclick="window.App.toggleFaq(this)" class="w-full flex justify-between items-center p-6 text-left hover:bg-gray-50 transition-colors">
                                <span class="font-bold text-lg text-gray-800 flex items-center gap-3"><span class="text-indigo-600">Q.</span> 큐레이팅 진행 방식이 어떻게 되나요?</span>
                                <i data-lucide="chevron-down" class="text-gray-400 transition-transform duration-300"></i>
                            </button>
                            <div class="hidden px-6 pb-6 pt-0 text-gray-600 leading-relaxed pl-12 border-t border-dashed border-gray-100 mt-2">
                                결제 후 사전 설문지를 작성해주시면, 시크릿브라더가 직접 분석 후 7일간 카카오톡을 통해 실시간으로 1:1 상담과 솔루션을 제공해드립니다.
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl border border-gray-200 overflow-hidden">
                            <button onclick="window.App.toggleFaq(this)" class="w-full flex justify-between items-center p-6 text-left hover:bg-gray-50 transition-colors">
                                <span class="font-bold text-lg text-gray-800 flex items-center gap-3"><span class="text-indigo-600">Q.</span> 결제 후 언제부터 시작되나요?</span>
                                <i data-lucide="chevron-down" class="text-gray-400 transition-transform duration-300"></i>
                            </button>
                            <div class="hidden px-6 pb-6 pt-0 text-gray-600 leading-relaxed pl-12 border-t border-dashed border-gray-100 mt-2">
                                결제 완료 후 24시간 이내에 해피콜(또는 안내 문자)을 드리며, 고객님의 일정에 맞춰 상담 시작일을 조율합니다.
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- [VIEW 2] 전체 후기 화면 -->
        <div id="view-reviews" class="view-section hidden">
            <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
                <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                    <button onclick="window.App.navigate('home')" class="flex items-center gap-2 group text-indigo-600 font-bold hover:text-indigo-800 transition-colors">
                        <i data-lucide="arrow-left" class="w-6 h-6"></i> 홈으로 돌아가기
                    </button>
                    <div class="text-xl font-bold text-indigo-900">수강생 리얼 후기</div>
                </div>
            </header>
            
            <div class="max-w-7xl mx-auto px-4 py-12">
                <div class="flex flex-col md:flex-row justify-between items-end mb-8 gap-4">
                    <div>
                        <h1 class="text-3xl font-jalnan text-gray-900 mb-2">실시간 수강 후기</h1>
                        <p class="text-gray-600">지금 이 순간에도 새로운 후기가 올라오고 있습니다. (총 <span id="total-review-count" class="font-bold text-indigo-600">0</span>개)</p>
                    </div>
                    <button onclick="window.App.checkWritePermission()" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all shadow-md flex items-center gap-2">
                        <i data-lucide="pen-tool" class="w-4 h-4"></i> 나도 후기 쓰기
                    </button>
                </div>
                
                <div id="all-reviews-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- JS로 렌더링 -->
                </div>
                
                <div class="text-center mt-12">
                    <button id="load-more-btn" onclick="window.App.loadMoreReviews()" class="bg-white border border-gray-300 text-gray-600 px-12 py-3 rounded-full font-bold hover:border-indigo-600 hover:text-indigo-600 transition-all">
                        후기 더보기 +
                    </button>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400 py-16 text-sm mt-auto">
        <div class="max-w-7xl mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-10 border-b border-gray-800 pb-10 mb-10">
                <div>
                    <h3 class="text-white text-2xl font-jalnan mb-4">SecretClass</h3>
                    <p class="leading-relaxed opacity-70 break-keep">시크릿클래스는 여러분의 경제적 자유를 응원합니다.<br>투자는 본인의 판단과 책임하에 이루어져야 하며, 저희는 올바른 투자의 기준과 원칙을 제시합니다.</p>
                </div>
                <div class="md:text-right">
                    <h4 class="text-white font-bold mb-4">Customer Center</h4>
                    <p class="text-lg font-bold text-white mb-1">010-8298-4024</p>
                    <p class="opacity-60 mb-6">평일 10:00 - 18:00 (점심시간 12:00 - 13:00)</p>
                </div>
            </div>
            <div class="text-center text-xs opacity-40">© 2025 SecretClass. All rights reserved.</div>
        </div>
    </footer>

    <!-- ================= MODALS ================= -->

    <!-- 1. 로그인/회원가입 모달 -->
    <div id="loginModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm transition-opacity" onclick="window.App.closeModal('loginModal')">
        <div class="bg-white w-full max-w-md rounded-2xl p-8 shadow-2xl relative" onclick="event.stopPropagation()">
            <button onclick="window.App.closeModal('loginModal')" class="absolute top-4 right-4 text-gray-400 hover:text-black"><i data-lucide="x"></i></button>
            <div class="flex border-b border-gray-200 mb-6">
                <button id="tab-login" onclick="window.App.switchAuthTab('login')" class="flex-1 py-3 font-bold text-indigo-600 border-b-2 border-indigo-600 transition-colors">로그인</button>
                <button id="tab-signup" onclick="window.App.switchAuthTab('signup')" class="flex-1 py-3 font-bold text-gray-400 hover:text-gray-600 transition-colors">회원가입</button>
            </div>
            
            <!-- 로그인 폼 -->
            <div id="form-login" class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">이메일 (아이디)</label>
                    <input type="email" id="login-email" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 focus:outline-none focus:border-indigo-500 transition-colors" placeholder="example@email.com">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">비밀번호</label>
                    <input type="password" id="login-pw" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 focus:outline-none focus:border-indigo-500 transition-colors" placeholder="비밀번호 입력">
                </div>
                <button onclick="window.App.processLogin()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all mt-2">로그인</button>
            </div>

            <!-- 회원가입 폼 (데이터 수집용) -->
            <div id="form-signup" class="hidden space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-1">
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">이름 (실명)</label>
                    <input type="text" id="reg-name" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:border-indigo-500" placeholder="홍길동">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">이메일 (로그인용 아이디)</label>
                    <input type="email" id="reg-email" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:border-indigo-500" placeholder="example@email.com">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">비밀번호 (6자리 이상)</label>
                    <input type="password" id="reg-pw" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:border-indigo-500" placeholder="********">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">단톡방 아이디 (또는 닉네임)</label>
                    <input type="text" id="reg-chatId" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:border-indigo-500" placeholder="카카오톡 아이디 또는 닉네임">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">가입경로</label>
                    <select id="reg-path" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:border-indigo-500">
                        <option value="blog">블로그 (성공한 형의 비밀일기장)</option>
                        <option value="youtube">유튜브 (시크릿브라더)</option>
                        <option value="friend">지인 추천</option>
                        <option value="other">기타</option>
                    </select>
                </div>
                <button onclick="window.App.processSignup()" class="w-full bg-gray-900 hover:bg-gray-800 text-white py-4 rounded-xl font-bold shadow-lg transition-all mt-4">가입완료</button>
            </div>
        </div>
    </div>

    <!-- 2. 입금 신청 모달 -->
    <div id="depositModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onclick="window.App.closeModal('depositModal')">
        <div class="bg-white w-full max-w-md rounded-2xl p-8 relative" onclick="event.stopPropagation()">
            <button onclick="window.App.closeModal('depositModal')" class="absolute top-4 right-4 text-gray-400 hover:text-black"><i data-lucide="x"></i></button>
            <h3 class="text-2xl font-bold text-center mb-6 font-jalnan">무통장 입금 안내</h3>
            <div class="bg-gray-50 p-6 rounded-xl border border-gray-100 mb-6 text-center">
                <p class="text-gray-500 text-sm mb-1">기업은행</p>
                <p class="text-2xl font-bold text-indigo-600 cursor-pointer hover:scale-105 transition-transform" onclick="window.App.copyToClipboard('521-063745-04-011')">521-063745-04-011</p>
                <p class="text-xs text-gray-400 mt-2">(주)아율</p>
            </div>
            <button onclick="window.App.confirmDeposit()" class="block w-full bg-indigo-600 text-white py-4 rounded-xl font-bold text-center hover:bg-indigo-700 shadow-lg transition-all">입금 확인 요청 (관리자 승인 대기)</button>
        </div>
    </div>

    <!-- 3. 후기 상세 모달 (전체 원본 보기) -->
    <div id="reviewDetailModal" class="hidden fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onclick="window.App.closeModal('reviewDetailModal')">
        <div class="bg-white w-full max-w-3xl max-h-[85vh] rounded-2xl shadow-2xl relative flex flex-col overflow-hidden" onclick="event.stopPropagation()">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h3 class="font-bold text-gray-900">후기 원본 보기</h3>
                <button onclick="window.App.closeModal('reviewDetailModal')" class="text-gray-400 hover:text-gray-600"><i data-lucide="x"></i></button>
            </div>
            <div class="p-8 overflow-y-auto flex-grow custom-scrollbar">
                <div class="flex items-center gap-2 mb-4" id="modal-stars"></div>
                <h2 id="modal-review-title" class="text-2xl font-bold text-gray-900 mb-6 leading-snug break-keep"></h2>
                <!-- 여기서 raw-content 클래스가 원본 텍스트 서식을 보존합니다 -->
                <div id="modal-review-content" class="raw-content"></div>
                
                <div class="mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-sm text-gray-500">
                    <div class="flex items-center gap-2">
                        <span class="font-bold text-gray-900" id="modal-review-author"></span>
                        <span class="w-px h-3 bg-gray-300"></span>
                        <span id="modal-review-date"></span>
                    </div>
                </div>
            </div>
            <div class="p-4 bg-gray-50 border-t border-gray-100 text-center">
                <button onclick="window.App.closeModal('reviewDetailModal')" class="w-full bg-gray-900 text-white py-3 rounded-xl font-bold hover:bg-gray-800 transition-colors">닫기</button>
            </div>
        </div>
    </div>

    <!-- 4. 후기 작성 모달 -->
    <div id="writeReviewModal" class="hidden fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onclick="window.App.closeModal('writeReviewModal')">
        <div class="bg-white w-full max-w-lg rounded-2xl shadow-2xl relative" onclick="event.stopPropagation()">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h3 class="font-bold text-gray-900">후기 작성</h3>
                <button onclick="window.App.closeModal('writeReviewModal')" class="text-gray-400 hover:text-black"><i data-lucide="x"></i></button>
            </div>
            <div class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">제목</label>
                    <input type="text" id="w-title" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:border-indigo-500 focus:outline-none" placeholder="제목을 입력하세요">
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">내용</label>
                    <textarea id="w-content" rows="8" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:border-indigo-500 focus:outline-none" placeholder="솔직한 후기를 남겨주세요"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">별점</label>
                    <select id="w-rating" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:border-indigo-500 focus:outline-none">
                        <option value="5">★★★★★ (5점)</option>
                        <option value="4">★★★★☆ (4점)</option>
                        <option value="3">★★★☆☆ (3점)</option>
                    </select>
                </div>
                <button onclick="window.App.submitReview()" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all mt-2">등록하기</button>
            </div>
        </div>
    </div>

    <!-- 5. 마이페이지 모달 -->
    <div id="mypageModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onclick="window.App.closeModal('mypageModal')">
        <div class="bg-white w-full max-w-sm rounded-2xl p-0 shadow-2xl overflow-hidden relative" onclick="event.stopPropagation()">
            <div class="bg-indigo-600 p-6 text-white text-center relative">
                <button onclick="window.App.closeModal('mypageModal')" class="absolute top-4 right-4 text-white/70 hover:text-white"><i data-lucide="x"></i></button>
                <div class="w-16 h-16 bg-white rounded-full mx-auto mb-3 flex items-center justify-center text-2xl font-bold text-indigo-600">S</div>
                <h3 class="font-bold text-lg" id="mp-name">게스트</h3>
                <p class="text-xs text-indigo-200" id="mp-email">로그인이 필요합니다</p>
            </div>
            <div class="p-6">
                <div id="mp-status-guest" class="text-center py-4">
                    <p class="text-gray-500 mb-4 text-sm">로그인 후 이용해주세요.</p>
                    <button onclick="window.App.closeModal('mypageModal'); window.App.openModal('loginModal','login')" class="w-full bg-indigo-600 text-white py-2 rounded-lg font-bold text-sm">로그인하기</button>
                </div>
                <div id="mp-status-user" class="hidden text-center space-y-3">
                    <div id="pay-none" class="bg-gray-100 p-4 rounded-xl">
                        <p class="text-gray-500 text-xs mb-2">수강 신청 내역이 없습니다.</p>
                        <button onclick="window.App.closeModal('mypageModal'); window.App.scrollToSection('pricing')" class="text-indigo-600 font-bold text-sm hover:underline">신청하러 가기</button>
                    </div>
                    <div id="pay-pending" class="hidden bg-yellow-50 p-4 rounded-xl border border-yellow-100">
                        <p class="font-bold text-yellow-700 text-sm">입금 확인 중입니다</p>
                        <p class="text-xs text-yellow-600 mt-1">관리자 승인 대기중</p>
                    </div>
                    <div id="pay-complete" class="hidden bg-green-50 p-4 rounded-xl border border-green-100">
                        <p class="font-bold text-green-700 text-sm mb-2">PREMIUM 수강 중</p>
                        <a href="https://open.kakao.com/o/sfyp9Qxh" target="_blank" class="block bg-[#FEE500] py-2 rounded-lg text-xs font-bold text-[#3c1e1e]">1:1 채팅방 입장</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 6. 관리자 모달 (업그레이드: 실제 회원 데이터 연동) -->
    <div id="adminModal" class="hidden fixed inset-0 z-[120] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onclick="window.App.closeModal('adminModal')">
        <div class="bg-white w-full max-w-4xl rounded-2xl p-0 shadow-2xl overflow-hidden relative flex flex-col max-h-[85vh]" onclick="event.stopPropagation()">
            <div class="bg-gray-800 p-6 text-white flex justify-between items-center shrink-0">
                <div>
                    <h3 class="font-bold text-lg"><i data-lucide="shield" class="w-5 h-5 inline mr-1"></i> 관리자 패널</h3>
                    <p class="text-xs text-gray-400">회원 정보 조회 및 입금 승인 관리</p>
                </div>
                <button onclick="window.App.closeModal('adminModal')" class="text-white/70 hover:text-white"><i data-lucide="x"></i></button>
            </div>
            
            <div class="p-6 overflow-y-auto bg-gray-50 flex-grow">
                <div class="mb-4 flex justify-between items-end">
                    <h4 class="font-bold text-gray-800">회원 목록 (실시간 연동)</h4>
                    <span class="text-xs text-gray-500">* 최근 가입순 정렬</span>
                </div>
                
                <!-- 테이블 헤더 -->
                <div class="hidden md:grid grid-cols-12 gap-2 text-xs font-bold text-gray-500 border-b border-gray-200 pb-2 mb-2 px-2">
                    <div class="col-span-2">이름</div>
                    <div class="col-span-3">이메일/ID</div>
                    <div class="col-span-2">단톡방ID</div>
                    <div class="col-span-2">가입경로</div>
                    <div class="col-span-1">상태</div>
                    <div class="col-span-2 text-right">관리</div>
                </div>

                <div id="admin-user-list" class="space-y-2">
                    <!-- JS로 데이터 로드 -->
                    <div class="text-center py-10 text-gray-400">데이터를 불러오는 중입니다...</div>
                </div>
            </div>
        </div>
    </div>

<script>
    // =========================================================
    // Static Data & Global Setup
    // =========================================================
    window.App = window.App || {};
    window.App.state = {
        isLoggedIn: false,
        user: null,
        reviews: [],
        visibleReviews: 9,
        isAdmin: false
    };

    // [중요] 후기 데이터
    // 제공해주신 원본 코드에 이미 '(중략)' 텍스트가 포함되어 있습니다.
    // 실제 원본 텍스트를 가지고 계시다면, 아래 content 부분을 수정해주시면 됩니다.
    // 시스템은 텍스트 길이 제한 없이 모두 보여주도록 설정되었습니다.
    window.STATIC_REVIEWS = [
        { id: 1, title: "3년간 못했던 내집마련, 시브님 만나고 2주만에 성공!", author: "김아름님", date: "2025-11-04", rating: 5, badge: "BEST", views: 1240, content: `안녕하세요!
결혼을 준비하던 약 3년 전부터 부동산을 째려보던 제가
시브님을 만나고 약 2주만에 서울에 내집 마련을 했습니다!
성격이 좋게 말하면 꼼꼼하고 나쁘게 말하면 의사 결정을 잘 못내리는데,
좋은 시기에 시브님을 만나 빠르게 의사결정 내려서 드디어 매수에 성공했습니다 :)

(중략 - 원본 텍스트가 있다면 이곳에 붙여넣어 주세요)

결론적으로 결혼 2년 전부터 3년간 째려봤던 부동산을
시브님을 만나고 2주 만에 매수 할 수 있게 되었습니다 :)

감사합니다 시브님 :)` },
        { id: 2, title: "시크릿큐레이팅후기_막막함에 확신이 생깁니다.", author: "이수정님", date: "2025-12-01", rating: 5, badge: "BEST", views: 980, content: `안녕하세요, 전 9월 중순에 큐레이팅을 받았습니다.
아시다시피 큐레이팅은 일주일간 진행되는데, 
다른 상담들은 한번만 진행되는 것에 비해 시크릿큐레이팅은 일주일이라는 시간이 주어지고
언제든 질문을 하고 답변을 받을 수 있다는 점이 참 좋았습니다.
 
(중략 - 원본 텍스트가 있다면 이곳에 붙여넣어 주세요)

30만원으로 3000만원의 가치를 줄 수 있다는 시크릿큐레이팅의 홍보문구는 과장이 아닙니다.
읽어주셔서 감사합니다.` },
        { id: 3, title: "큰 돈이 들어가는 만큼 전문가의 조언을 얻어야 한다.", author: "이서연님", date: "2025-11-27", rating: 5, badge: "BEST", views: 850, content: `안녕하세요? 이번 시크릿 큐레이팅을 받으며 감사하게도 한 주만에 매도와 매수를 모두 하였고 계약서 작성을 앞두고 있습니다.
저는 평소 시크릿브라더님 블로그를 보며 공부하고 있던 수강생입니다. 

(중략 - 원본 텍스트가 있다면 이곳에 붙여넣어 주세요)

결과적으로 좋은 물건을, 좋은 가격에 매수할 수 있었던 건 시크릿 큐레이팅 덕분입니다.` },
        { id: 4, title: "조정지역 발표 다음날 동탄 매수 시크릿큐레이팅 후기", author: "변미소님", date: "2025-11-12", rating: 5, badge: "BEST", views: 1100, content: `안녕하세요 전 추석직전 큐레이팅 신청하고 추석연휴동안 갈아타기를 위해 열심히 임장을 다녔습니다.
70일 아기를 데리고 임장을 하는 것이 정말 쉽지 않았는데요.

(중략 - 원본 텍스트가 있다면 이곳에 붙여넣어 주세요)

덕분에 저는 동탄을 갈아타기 해서 매수할 수 있었고 현재는 풍선효과로 가격이 제가 매수한 가격보다 많이 올랐습니다.
시부님의 큐레이팅은 이 가격에 믿을 수 없는 퀄리티 입니다.` },
        { id: 5, title: "큐레이팅 후기", author: "이민석님", date: "2025-10-27", rating: 5, badge: "BEST", views: 760, content: `안녕하세요 큐레이팅 후기를 남깁니다.
저는 추석 연휴가 끝나고 큐레이팅을 시작해서 한 주만에 살던 집을 매도하고 새집을 매수하게 되었습니다.

(중략 - 원본 텍스트가 있다면 이곳에 붙여넣어 주세요)

치열한 생각의 과정에서 옆에 있어 줬던 시크릿브라더에게 참 감사합니다.` },
        { id: 6, title: "[시크릿브라더] 부동산 큐레이팅 후기", author: "김기용님", date: "2025-10-27", rating: 5, badge: "BEST", views: 640, content: `안녕하세요, 
10월 초 추석 연휴 전 큐레이팅을 신청 하였고, 실거주와 갭투자를 고민하는 상황이었습니다. 
결론을 먼저 말씀 드리자면 시크릿브라더님 큐레이팅 조언을 통해 실거주집을 매수하기로 계약을 한 상태입니다.

(중략 - 원본 텍스트가 있다면 이곳에 붙여넣어 주세요)

솔직히 질문에 대한 시브님의 답을 듣는 과정이 길지 않았고 명쾌했습니다.` }
    ];

    // 헬퍼 함수
    window.$ = (id) => document.getElementById(id);
    
    // UI 함수 모음 (모듈 로딩 전에도 작동하도록)
    window.App.navigate = (page) => {
        document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
        const target = $(`view-${page}`);
        if(target) target.classList.remove('hidden');
        window.scrollTo(0, 0);
    };

    window.App.scrollToSection = (id) => {
        if($('view-home').classList.contains('hidden')) window.App.navigate('home');
        setTimeout(() => document.getElementById(id)?.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
    };

    window.App.toggleMobileMenu = () => $('mobileMenu').classList.toggle('hidden');
    
    window.App.openModal = (id, tab) => {
        const el = $(id);
        if(el) {
            el.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            if(tab && window.App.switchAuthTab) window.App.switchAuthTab(tab);
        }
    };

    window.App.closeModal = (id) => {
        const el = $(id);
        if(el) {
            el.classList.add('hidden');
            document.body.style.overflow = '';
        }
    };

    window.App.switchAuthTab = (tab) => {
        const loginForm = $('form-login');
        const signupForm = $('form-signup');
        const loginTab = $('tab-login');
        const signupTab = $('tab-signup');
        
        if (tab === 'login') {
            loginForm.classList.remove('hidden');
            signupForm.classList.add('hidden');
            loginTab.className = "flex-1 py-3 font-bold text-indigo-600 border-b-2 border-indigo-600 transition-colors";
            signupTab.className = "flex-1 py-3 font-bold text-gray-400 hover:text-gray-600 transition-colors";
        } else {
            loginForm.classList.add('hidden');
            signupForm.classList.remove('hidden');
            signupTab.className = "flex-1 py-3 font-bold text-indigo-600 border-b-2 border-indigo-600 transition-colors";
            loginTab.className = "flex-1 py-3 font-bold text-gray-400 hover:text-gray-600 transition-colors";
        }
    };

    window.App.toggleFaq = (btn) => {
        const answer = btn.nextElementSibling;
        const icon = btn.querySelector('svg');
        answer.classList.toggle('hidden');
        if(icon) icon.style.transform = answer.classList.contains('hidden') ? 'rotate(0deg)' : 'rotate(180deg)';
    };

    window.App.copyToClipboard = (text) => {
        const el = document.createElement('textarea');
        el.value = text;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        alert("계좌번호가 복사되었습니다.");
    };
</script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, collection, query, onSnapshot, addDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // 1. Firebase 설정 (자동 주입)
  const firebaseConfig = {
  apiKey: "AIzaSyCvFTB5GVkVZLLVilv_hCoJ0Fcjn-w-tyY",
  authDomain: "secretclass-5c9d8.firebaseapp.com",
  projectId: "secretclass-5c9d8",
  storageBucket: "secretclass-5c9d8.firebasestorage.app",
  messagingSenderId: "316837263466",
  appId: "1:316837263466:web:ae28f1110f3728ea8ab213",
  measurementId: "G-8GPZWFNNC6"
};


    // 2. 관리자 이메일 설정
    const adminEmail = "admin@secretclass.com";

    // 3. 인증 초기화
    const initAuth = async () => {
        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
            await signInWithCustomToken(auth, __initial_auth_token);
        } else {
            // 자동 익명 로그인 방지 (명시적 로그인 유도)
            // await signInAnonymously(auth); 
        }
    };
    initAuth();

    // 4. 컬렉션 참조 헬퍼
    // 중요: 모든 회원 데이터는 public/data/members 에도 저장하여 관리자가 조회 가능하게 함
    const getMembersColl = () => collection(db, 'artifacts', appId, 'public', 'data', 'members');
    const getReviewsColl = () => collection(db, 'artifacts', appId, 'public', 'data', 'reviews');
    // 개인 프로필은 users 경로에 저장 (보안)
    const getUserProfileDoc = (uid) => doc(db, 'artifacts', appId, 'users', uid, 'profile', 'info');

    // 5. 비즈니스 로직
    const Impl = {
        // UI 렌더링
        renderUI: () => {
            const isUser = window.App.state.isLoggedIn;
            const user = window.App.state.user;

            // 헤더 상태
            $('auth-guest').classList.toggle('hidden', isUser);
            const userDiv = $('auth-user');
            if(isUser) {
                userDiv.classList.remove('hidden-section');
                userDiv.style.display = 'flex';
                $('user-name-display').innerText = user.name;
                // 관리자 버튼
                const adminBtn = $('btn-admin-open');
                if(window.App.state.isAdmin) adminBtn.classList.remove('hidden');
                else adminBtn.classList.add('hidden');
            } else {
                userDiv.classList.add('hidden-section');
                userDiv.style.display = 'none';
            }

            Impl.renderReviews();
        },

        renderReviews: () => {
            // 정적 데이터 + DB 데이터 병합
            let allReviews = [...window.App.state.reviews];
            if(allReviews.length === 0) allReviews = [...window.STATIC_REVIEWS];
            
            // BEST 리뷰
            const bests = allReviews.filter(r => r.badge === 'BEST').slice(0, 6);
            const bestContainer = $('best-reviews-container');
            if(bestContainer) bestContainer.innerHTML = bests.map(r => Impl.createReviewCard(r, true)).join('');

            // 전체 리뷰 (더보기 기능 포함)
            const visible = allReviews.slice(0, window.App.state.visibleReviews);
            const allContainer = $('all-reviews-container');
            if(allContainer) allContainer.innerHTML = visible.map(r => Impl.createReviewCard(r, false)).join('');

            // 카운트
            const cnt = $('total-review-count');
            if(cnt) cnt.innerText = allReviews.length;

            // 더보기 버튼
            const loadBtn = $('load-more-btn');
            if(loadBtn) loadBtn.style.display = (window.App.state.visibleReviews >= allReviews.length) ? 'none' : 'inline-block';

            if(window.lucide) window.lucide.createIcons();
        },

        createReviewCard: (review, isBest) => {
            let stars = '';
            for(let i=0; i<5; i++) stars += `<i data-lucide="star" class="w-3 h-3 ${i < review.rating ? 'text-yellow-400 fill-current' : 'text-gray-300'}"></i>`;
            
            let badgeHtml = '';
            if(review.badge === 'BEST') badgeHtml = `<span class="bg-red-100 text-red-600 text-[10px] font-bold px-1.5 py-0.5 rounded">BEST</span>`;
            
            // 카드에서는 line-clamp-custom 으로 줄여서 보여줌 (디자인 유지)
            // 모달에서는 raw-content 로 전체 보여줌
            return `
            <div onclick="window.App.openReviewDetail('${review.id}')" class="bg-white p-6 rounded-2xl border ${isBest ? 'border-indigo-100 shadow-md' : 'border-gray-100'} hover:shadow-xl transition-all duration-300 cursor-pointer flex flex-col justify-between h-full group">
                <div>
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex gap-1 items-center">${stars}</div>
                        ${badgeHtml}
                    </div>
                    <h3 class="font-bold text-lg mb-2 text-gray-900 line-clamp-1 group-hover:text-indigo-600 transition-colors">${review.title}</h3>
                    <p class="text-sm text-gray-500 line-clamp-custom mb-4 leading-relaxed break-keep text-left">${review.content}</p>
                </div>
                <div class="pt-4 border-t border-gray-50 flex justify-between items-center text-xs text-gray-400">
                    <div class="flex items-center gap-2">
                        <span class="font-bold text-gray-700">${review.author}</span>
                        <span>${review.date}</span>
                    </div>
                    <div class="flex items-center gap-1"><i data-lucide="eye" class="w-3 h-3"></i> ${review.views ? review.views.toLocaleString() : 0}</div>
                </div>
            </div>`;
        },

        // 로그인 처리
        processLogin: async () => {
            const email = $('login-email').value;
            const pw = $('login-pw').value;
            if(!email || !pw) return alert("아이디(이메일)와 비밀번호를 입력해주세요.");

            try {
                await signInWithEmailAndPassword(auth, email, pw);
                alert("반갑습니다! 로그인되었습니다.");
                window.App.closeModal('loginModal');
            } catch(e) {
                console.error(e);
                alert("로그인 실패: 아이디 또는 비밀번호를 확인해주세요.");
            }
        },

        // 회원가입 처리 (데이터 수집 포함)
        processSignup: async () => {
            const name = $('reg-name').value;
            const email = $('reg-email').value;
            const pw = $('reg-pw').value;
            const chatId = $('reg-chatId').value;
            const joinPath = $('reg-path').value;

            if(!name || !email || !pw || !chatId) return alert("모든 정보를 입력해주세요.");
            if(pw.length < 6) return alert("비밀번호는 6자리 이상이어야 합니다.");

            try {
                // 1. Auth 생성
                const cred = await createUserWithEmailAndPassword(auth, email, pw);
                const uid = cred.user.uid;

                // 2. 데이터 구성
                const userData = {
                    name: name,
                    email: email,
                    chatId: chatId,
                    joinPath: joinPath,
                    payStatus: 'none', // none, pending, complete
                    joinDate: new Date().toISOString()
                };

                // 3. Firestore 저장 (Profile & Public Members List)
                await setDoc(getUserProfileDoc(uid), userData);
                await setDoc(doc(getMembersColl(), uid), userData);

                alert("회원가입이 완료되었습니다! 환영합니다.");
                window.App.switchAuthTab('login');
                // 자동 로그인 되지 않게 하거나, 바로 로그인 처리
                // 여기선 폼 초기화 후 로그인 유도
                $('reg-name').value = '';
                $('reg-email').value = '';
                $('reg-pw').value = '';
                $('reg-chatId').value = '';
            } catch(e) {
                console.error(e);
                if(e.code === 'auth/email-already-in-use') alert("이미 가입된 이메일입니다.");
                else alert("가입 중 오류가 발생했습니다: " + e.message);
            }
        },

        // 입금 확인 요청
        confirmDeposit: async () => {
            if(!window.App.state.isLoggedIn) return alert("로그인 후 신청해주세요.");
            
            if(!confirm("입금 확인 요청을 보내시겠습니까?")) return;

            const uid = window.App.state.user.uid;
            try {
                // 내 정보 업데이트
                await updateDoc(getUserProfileDoc(uid), { payStatus: 'pending' });
                // 관리자용 리스트 업데이트
                await updateDoc(doc(getMembersColl(), uid), { payStatus: 'pending' });
                
                // 로컬 상태 즉시 반영
                window.App.state.user.payStatus = 'pending';
                window.App.closeModal('depositModal');
                alert("신청되었습니다. 관리자 승인 후 수강이 가능합니다.");
                window.App.openMypage();
            } catch(e) {
                console.error(e);
                alert("오류가 발생했습니다.");
            }
        }
    };

    // 6. Window 객체에 함수 바인딩
    window.App.processLogin = Impl.processLogin;
    window.App.processSignup = Impl.processSignup;
    window.App.confirmDeposit = Impl.confirmDeposit;

    window.App.logout = () => {
        if(confirm("로그아웃 하시겠습니까?")) signOut(auth);
    };

    // 더보기
    window.App.loadMoreReviews = () => {
        window.App.state.visibleReviews += 9;
        Impl.renderReviews();
    };

    // 후기 작성 권한 체크
    window.App.checkWritePermission = () => {
        if(!window.App.state.isLoggedIn) {
            alert("로그인이 필요합니다.");
            window.App.openModal('loginModal', 'login');
            return;
        }
        const status = window.App.state.user.payStatus;
        if(status === 'complete' || window.App.state.isAdmin) {
            window.App.openModal('writeReviewModal');
        } else if (status === 'pending') {
            alert("수강 승인 대기중입니다.");
        } else {
            alert("수강생만 후기를 작성할 수 있습니다.");
        }
    };

    // 후기 제출
    window.App.submitReview = async () => {
        const title = $('w-title').value;
        const content = $('w-content').value;
        const rating = $('w-rating').value;
        
        if(!title || !content) return alert("내용을 입력해주세요.");

        try {
            await addDoc(getReviewsColl(), {
                title, content, rating,
                author: window.App.state.user.name, // 이름 기록
                date: new Date().toISOString().split('T')[0],
                views: 0,
                userId: window.App.state.user.uid,
                badge: 'NEW'
            });
            alert("후기가 등록되었습니다!");
            window.App.closeModal('writeReviewModal');
            $('w-title').value = '';
            $('w-content').value = '';
        } catch(e) {
            console.error(e);
            alert("등록 실패: " + e.message);
        }
    };

    // 후기 상세 보기 (모달)
    window.App.openReviewDetail = (id) => {
        // DB리뷰 + 정적리뷰 통합 검색
        let allReviews = [...window.App.state.reviews];
        if(allReviews.length === 0) allReviews = [...window.STATIC_REVIEWS];
        
        const review = allReviews.find(r => String(r.id) === String(id));
        if(!review) return;

        // 뷰카운트 증가 (DB 연동 시 여기서 updateDoc 하면 좋음)
        // 여기선 UI만 처리
        review.views = (review.views || 0) + 1;

        $('modal-review-title').innerText = review.title;
        $('modal-review-author').innerText = review.author;
        $('modal-review-date').innerText = review.date;
        
        // [중요] 모달 내용은 HTML이 아닌 텍스트로 처리하여 보안 강화하되
        // CSS white-space: pre-wrap 으로 줄바꿈 보존
        $('modal-review-content').innerText = review.content;

        let stars = '';
        for(let i=0; i<5; i++) stars += `<i data-lucide="star" class="w-4 h-4 ${i < review.rating ? 'text-yellow-400 fill-current' : 'text-gray-300'}"></i>`;
        $('modal-stars').innerHTML = stars;

        window.App.openModal('reviewDetailModal');
        if(window.lucide) window.lucide.createIcons();
    };

    // 마이페이지 열기
    window.App.openMypage = () => {
        window.App.openModal('mypageModal');
        const isUser = window.App.state.isLoggedIn;
        
        $('mp-status-guest').classList.toggle('hidden', isUser);
        $('mp-status-user').classList.toggle('hidden', !isUser);

        if(isUser && window.App.state.user) {
            $('mp-name').innerText = window.App.state.user.name + "님";
            $('mp-email').innerText = window.App.state.user.email;
            
            const ps = window.App.state.user.payStatus;
            $('pay-none').classList.toggle('hidden', ps !== 'none');
            $('pay-pending').classList.toggle('hidden', ps !== 'pending');
            $('pay-complete').classList.toggle('hidden', ps !== 'complete');
        }
    };

    // 관리자 패널 열기
    window.App.openAdminModal = () => {
        if(!window.App.state.isAdmin) return alert("관리자 권한이 없습니다.");
        window.App.openModal('adminModal');

        const listEl = $('admin-user-list');
        listEl.innerHTML = '<div class="text-center py-4">데이터 로딩중...</div>';

        // 실시간 회원 목록 리스닝
        onSnapshot(getMembersColl(), (snapshot) => {
            if(snapshot.empty) {
                listEl.innerHTML = '<div class="text-center py-10 text-gray-400">가입한 회원이 없습니다.</div>';
                return;
            }
            
            const members = [];
            snapshot.forEach(d => members.push({ id: d.id, ...d.data() }));
            // 최신 가입순
            members.sort((a,b) => (b.joinDate||'').localeCompare(a.joinDate||''));

            listEl.innerHTML = members.map(m => {
                let statusBadge = '';
                let btn = '';
                
                if(m.payStatus === 'complete') {
                    statusBadge = '<span class="text-green-600 bg-green-100 px-2 py-0.5 rounded text-[10px] font-bold">수강중</span>';
                    btn = `<button onclick="window.App.setPayStatus('${m.id}', 'none')" class="text-xs text-red-500 hover:underline">취소</button>`;
                } else if (m.payStatus === 'pending') {
                    statusBadge = '<span class="text-yellow-600 bg-yellow-100 px-2 py-0.5 rounded text-[10px] font-bold animate-pulse">승인대기</span>';
                    btn = `<button onclick="window.App.setPayStatus('${m.id}', 'complete')" class="text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700">승인하기</button>`;
                } else {
                    statusBadge = '<span class="text-gray-400 bg-gray-100 px-2 py-0.5 rounded text-[10px]">미결제</span>';
                    btn = `<button onclick="window.App.setPayStatus('${m.id}', 'complete')" class="text-xs text-indigo-500 hover:underline">강제승인</button>`;
                }

                // 가입 경로 뱃지
                const pathMap = { 'blog': '블로그', 'youtube': '유튜브', 'friend': '지인', 'other': '기타' };
                const pathName = pathMap[m.joinPath] || m.joinPath || '-';

                return `
                <div class="grid grid-cols-12 gap-2 items-center p-3 bg-white border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors text-sm">
                    <div class="col-span-2 font-bold truncate">${m.name}</div>
                    <div class="col-span-3 text-xs text-gray-500 truncate" title="${m.email}">${m.email}</div>
                    <div class="col-span-2 text-xs text-indigo-600 truncate">${m.chatId || '-'}</div>
                    <div class="col-span-2 text-xs text-gray-500">${pathName}</div>
                    <div class="col-span-1">${statusBadge}</div>
                    <div class="col-span-2 text-right">${btn}</div>
                </div>
                `;
            }).join('');
        });
    };

    // 관리자 상태 변경 함수
    window.App.setPayStatus = async (uid, status) => {
        if(!confirm("상태를 변경하시겠습니까?")) return;
        await updateDoc(doc(getMembersColl(), uid), { payStatus: status });
        await updateDoc(getUserProfileDoc(uid), { payStatus: status }); // 개인 프로필도 동기화
    };

    // 7. Auth 상태 감지
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            // 관리자 여부 체크
            const isAdmin = (user.email === adminEmail);
            
            // 프로필 가져오기
            try {
                const snap = await getDoc(getUserProfileDoc(user.uid));
                if(snap.exists()) {
                    window.App.state.user = { uid: user.uid, ...snap.data() };
                } else {
                    // 프로필 없으면 기본 생성 (구버전 호환)
                    const baseProfile = { name: user.displayName || '회원', email: user.email, payStatus: 'none' };
                    window.App.state.user = { uid: user.uid, ...baseProfile };
                }
            } catch(e) {
                console.error(e);
            }
            
            window.App.state.isLoggedIn = true;
            window.App.state.isAdmin = isAdmin;

            // 후기 실시간 구독
            onSnapshot(getReviewsColl(), (snap) => {
                const dbReviews = [];
                snap.forEach(d => dbReviews.push({ id: d.id, ...d.data() }));
                dbReviews.sort((a,b) => new Date(b.date) - new Date(a.date));
                window.App.state.reviews = dbReviews;
                Impl.renderReviews();
            });

        } else {
            window.App.state.isLoggedIn = false;
            window.App.state.user = null;
            window.App.state.isAdmin = false;
            window.App.state.reviews = [];
        }
        
        Impl.renderUI();
    });

</script>
</body>
</html>